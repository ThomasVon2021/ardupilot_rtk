# GRTK 常用配置命令

!!! warning "非专业人士请在技术人员指导下配置，对由于错误配置导致设备失效损坏，恕概不负责"
    * 对GRTK的常用配置指令进行总结和示例，以方便客户可以根据自己的需求对GRTK实现定制化配置


## 常用配置指令

GRTK输入指令支持简化 ASCII 格式，所有指令由指令头和配置参数（参数部分可以为空，则该指令只有一个指令头）组成，头字段包含指令名称或消息头。常用指令如下表所示：


| 序号  | 设备/功能 | 功能                                                                                                                                                                         |
|-----|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1   | freset  | 恢复出厂设置，注意：出厂设置的波特率为 115200                                                                                                                                                 |
| 2   | config  | 查询接收机串口状态                                                                                                                                                                  |
| 3   | mask BDS  | 禁用 BDS 卫星系统 </br> 可以分别禁用 BDS、GPS、GLO、GAL                                                                                                                                   |
| 4   | unmask BDS   | 启用 BDS 卫星系统 </br> 可以分别启用 BDS、GPS、GLO、GAL；</br>接收机默认跟踪所有卫星系统                                                                                                                |
| 5   | unlog | 禁止当前串口所有输出                                                                                                                                                                 |
| 6   | saveconfig  | 保存设置                                                                                                                                                                       |
| 7   | mode base time 60 1.5 2.5  | 定位后 60 秒时或者水平精度优于 1.5 米高程精度优于 2.5米，自动生成基准点坐标。</br>断电重启后，将重复计算并生成新基准点坐标                                                                                                     |
| 8   | mode base lat Lon height  | 手动设置基准点坐标为：lat,lon,height（断电重启后基准点坐标不变化）</br>举例 lat=40.07898324818, lon=116.23660197714, height=60.4265</br>注：经度纬度坐标可以通过 bestpos 命令获取；</br>若位置为南纬，Lat 值需输入负值；西经，lon 需输入负值。 |
| 9   | mode base  | 设置为基准站                                                                                                                                                                     |
| 10  | mode movingbase  | 设置为移动基站                                                                                                                        |
| 11  | mode rover   | 缺省 Rover 模式（该指令可使接收机从基站模式转换到流动站模式）                                                                                                               |
| 12  | rtcm1033 comx 10</br>rtcm1006 comx 10</br>rtcm1074 comx 1</br>rtcm1124 comx 1</br>rtcm1084 comx 1</br>rtcm1094 comx 1  | 基站模式设置 COMX，ICOMX,NCOMX 发送差分报文，</br>COMX 可以指定为 COM1、COM2、COM3 任意一个；</br>ICOMX：设备/功能名称列表</br></br>NCOMX：设备/功能名称列表                                                                                                                                                                |


## NMEA报文配置

GRTK的定位定向等GPS数据以NMEA报文格式进行输出，为高效利用NMEA报文获取所需GPS数据，通常仅配置常用的几种NMEA报文格式，包括但不限于GPGGA、GPRMC、GPHDT、KSXT等。

如对NEMA报文格式并不了解，可参考[NMEA格式详解](NMEA0183.md)。

??? note "**命令格式为：**"
    - GPXXX [设备/功能名称] [参数]

| 序号  | 设备/功能 | 功能                               |
|-----|-------|----------------------------------|
| 1   | gpgga comx 1  | 设置 1HZ 输出 GGA 消息</br>消息类型和更新率可自设；1、0.5、0.2、0.1 分别对应输出频率 1Hz、2Hz、5Hz、10Hz；</br>类型包括 GGA、RMC、ZDA、VTG、NTR |
| 2   | gphdt comx 1  | 输出当前时刻的航向信息 HDT</br>航向类型包括：HDT、TRA |


## Config指令

Config指令主要用于对GRTK外设（串口、天线等）属性，RTK等特性进行配置。

??? note "**命令格式为：**"
    - CONFIG [设备/功能名称] [参数]

| 序号  | 设备/功能 | 功能                               |
|-----|-------|----------------------------------|
| 1   | COM1  | COM1 串口，与 COM1 相关的配置，如波特率，奇偶校验比特 |
| 2   | COM2  | COM2 串口，与 COM2 相关的配置，如波特率，奇偶校验比特 |
| 3   | COM3  | COM3 串口，与 COM3 相关的配置，如波特率，奇偶校验比特 |
| 4   | RTK   | 配置 RTK 参数，如设置模式，差分有效时间 |
| 5   | DGPS  | 配置 DGPS 参数，如 DGPS 差分有效时间 |

### 配置查询

??? note "**命令格式为：**"
    - CONFIG

**消息输出示例：**


>$CONFIG,COM1,CONFIG COM1 460800*65</br>
>$CONFIG,COM2,CONFIG COM2 115200*23</br>
>$CONFIG,COM3,CONFIG COM3 115200*23</br>
>$CONFIG,PPS,CONFIG PPS ENABLE GPS POSITIVE 500000 1000 0 0*6E</br>
>$CONFIG,INS,CONFIG INS DISABLE*70</br>
>$CONFIG,INS,CONFIG INS ANGLE 0,0,0*75</br>
>$CONFIG,INS,CONFIG INS ALIGNMENTVEL 5.0*2F</br>
>$CONFIG,INS,CONFIG INS TIMEOUT 200*6D</br>


### 串口配置

??? note "**命令格式为：**"
    - CONFIG [串口设备号] [串口属性参数]

**命令示例**

```html
CONFIG COM1 115200
CONFIG COM1 115200 8 n 1
```

**串口支持的波特率**

| 串口   |波特率|
|------|---------------|
| COM1 |9600, 19200, 38400, 57600, 115200, 230400, 460800，921600|
| COM2 |9600, 19200, 38400, 57600, 115200, 230400, 460800，921600|
| COM3 |9600, 19200, 38400, 57600, 115200, 230400, 460800，921600|

**串口参数详解**

| 参数 | 描述          |
|--|-------------------------|
| 波特率 | 设置串口的波特率。 |
| 数据位 | 设置串口的数据位；若要设置串口的数据位，须确保前面的波特率不能为空。注: 数据传输中支持的数据位：7 或 8，目前产品仅支持 8 位。 |
| 奇偶校验 | 设置串口的奇偶校验；若要设置串口奇偶校验，须确保前面的参数不能为空。注：数据传输中支持的奇偶校验：N,E,O。目前产品仅支持 N。 |
| 停止位 | 设置串口的停止位；若要设置串口停止位，须确保前面的参数不能为空。注：数据传输中支持的停止位：1 或 2。目前产品仅支持 1 位。 |

### 双天线heading航向及俯仰改正值配置

??? note "**命令格式为：**"
    - CONFIG HEADING OFFSET [Headingoffset Pitchoffset]

**命令示例**

```html
CONFIG HEADING OFFSET 90 45
```

**Heading参数详解**

| 参数            | 描述                              |
|---------------|----------------------------------|
| Headingoffset | 航向角改正值，deg. 取值范围：-180.0 ~180.0 |
| Pitchoffset   | 俯仰角改正值，deg. 取值范围：-90.0 ~ 90.0 |

### RTK参数配置

??? note "**命令格式为：**"
    - CONFIG RTK [参数]

**命令示例**

```html
CONFIG RTK TIMEOUT 60
```

| 参数            | 描述                                                       |
|---------------|----------------------------------------------------------|
| TIMEOUT       | 0: 关闭 RTK 功能<br> 1-1800: 数据最大龄期（默认值=100），秒为单位。|
| RESET         | 重置 RTK 解算 |
| USER_DEFAULTS | RTK 动态模式，默认状态 |
| DISABLE       | 不计算 RTK 结果，包括浮点解和固定解 |


## Mode指令

Mode 指令用于设置GRTK模块的工作模式， 具体模式包括基准站工作模式，流动站工作模式，移动基站工作模式。

??? note "**命令格式为：**"
    - MODE [模式名称] [参数]

**命令示例**

```html
MODE BASE 40.45628476579 116.2859754968 58.0984
MODE ROVER
MODE MOVINGBASE
```

| 工作模式       | 描述                                      |
|------------|-----------------------------------------------|
| BASE       | 设置接收机作为基准站工作模式|
| ROVER      | 设置接收机作为流动站工作模式 |
| MOVINGBASE | 设置接收机为移动基站工作模式 |

